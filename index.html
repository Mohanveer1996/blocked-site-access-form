<!DOCTYPE html>
<html>
<head>
  <title>Blocked Site Access Request</title>
</head>
<body>
  <h2>Blocked Site Access Request Form</h2>
  <form id="requestForm">
    <label>Blocked Website:</label><br>
    <input type="text" id="BlockedWebsite" name="BlockedWebsite" required><br><br>

    <label>User Name:</label><br>
    <input type="text" id="UserName" name="UserName" required><br><br>

    <label>User Email:</label><br>
    <input type="email" id="UserEmail" name="UserEmail" required><br><br>

    <label>Manager Email:</label><br>
    <input type="email" id="ManagerEmail" name="ManagerEmail" required><br><br>

    <label>Reason:</label><br>
    <textarea id="Reason" name="Reason" required></textarea><br><br>

    <label>Duration (e.g. 1 day):</label><br>
    <input type="text" id="Duration" name="Duration" required><br><br>

    <button type="submit">Submit Request</button>
  </form>

  <p id="responseMsg"></p>

  <script>
    // Step 1: Prefill values from URL
    const params = new URLSearchParams(window.location.search);
    document.getElementById('BlockedWebsite').value = params.get('site') || '';
    document.getElementById('UserName').value = params.get('name') || '';
    document.getElementById('UserEmail').value = params.get('email') || '';

    // Step 2: Handle form submit
    const form = document.getElementById('requestForm');
    form.addEventListener('submit', async function (e) {
      e.preventDefault();

      const data = {
        BlockedWebsite: form.BlockedWebsite.value,
        UserName: form.UserName.value,
        UserEmail: form.UserEmail.value,
        ManagerEmail: form.ManagerEmail.value,
        Reason: form.Reason.value,
        Duration: form.Duration.value
      };

      try {
        const res = await fetch("https://YOUR-POWER-AUTOMATE-URL", {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        document.getElementById('responseMsg').innerText = "Request submitted successfully!";
        form.reset();
      } catch (err) {
        document.getElementById('responseMsg').innerText = "Failed to submit request.";
        console.error(err);
      }
    });
  </script>
</body>
</html>
